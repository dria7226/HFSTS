head_index += (++granularity_counter == DATA_AT(SETTINGS,HEAD_GRANULARITY));
head_index *= (head_capacity > head_index);
